<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <title>{% block title %}My Message Board{% endblock %}</title>
    
    <!-- Manifest & Theme Color -->
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <meta name="theme-color" content="#ff66cc">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register("{% static 'service-worker.js' %}")
            .then(function(registration) {
                console.log('Service Worker registered with scope:', registration.scope);
            })
            .catch(function(error) {
                console.log('Service Worker registration failed:', error);
            });
        }
    </script>

    <!-- Fun UI Enhancements for Your Daughters -->
    <style>
        /* Button Styles */
        .btn-primary {
            background-color: #FF1493;
            border-color: #FF1493;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            box-shadow: 0px 4px 10px rgba(255, 20, 147, 0.5); /* Pink glow */
        }

        .btn-primary:hover {
            background-color: #FFC0CB;
            border-color: #FFC0CB;
            box-shadow: 0px 6px 12px rgba(255, 192, 203, 0.7); /* Larger pink glow */
        }

        .btn-secondary {
            background-color: #1E90FF;
            border-color: #1E90FF;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            box-shadow: 0px 4px 10px rgba(30, 144, 255, 0.5); /* Blue glow */
        }

        .btn-secondary:hover {
            background-color: #ADD8E6;
            border-color: #ADD8E6;
            box-shadow: 0px 6px 12px rgba(173, 216, 230, 0.7); /* Larger blue glow */
        }

        /* Dark Mode Styling */
        .dark-mode {
            background-color: #121212;
            color: #ffffff;
        }

        .dark-mode .navbar,
        .dark-mode .card {
            background-color: #333333;
            color: #ffffff;
        }

        .dark-mode .btn-primary {
            background-color: #bb86fc;
            border-color: #bb86fc;
        }

        /* Speech Bubble Styling */
        .speech-bubble {
            background-color: #ff66cc;
            color: #fff;
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 20px;
            padding: 20px;
            max-width: 300px;
            font-size: 1.2rem;
            text-align: center;
            display: none; /* Hidden by default */
            box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.2);
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 10px;
            border-style: solid;
            border-color: #ff66cc transparent transparent transparent;
        }

        .speech-bubble.show {
            display: block; /* Show the speech bubble */
            animation: fadeInOut 5s forwards;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Gradient Background */
        body {
            background: linear-gradient(90deg, #ff66cc, #ff99ff, #ffb3ff, #ffccff);
            background-size: 400% 400%;
            animation: gradientBG 10s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>

    {% block extra_head %}{% endblock %}
</head>

<body>

    <!-- Dark Mode Toggle Button -->
    <div class="container mt-3 text-center">
        <button id="darkModeToggle" class="btn btn-secondary">Toggle Dark Mode</button>
    </div>

    <!-- Speech Bubble for Error Messages -->
    <div id="errorMessage" class="speech-bubble"></div>

    <!-- Fun Sparkle Welcome -->
    <div class="container text-center mt-3">
        <h1 class="sparkle">Welcome to the Coolest Message Board Ever!</h1>
    </div>

    <div class="container mt-4 neon-border">
        {% block content %}{% endblock %}
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark mt-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="{% url 'welcome' %}">Message Board</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    {% if user.is_authenticated %}
                    <li class="nav-item"><a class="nav-link" href="{% url 'profile' user.username %}">Profile</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'create_post' %}">New Post</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'logout' %}">Logout</a></li>
                    {% else %}
                    <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Login</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'register' %}">Register</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Footer with Love -->
    <footer class="text-center">
        <p>&copy; 2024 Message Board | Built with ❤️ and Python</p>
    </footer>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Dark Mode Toggle -->
    <script>
        const toggleButton = document.getElementById('darkModeToggle');
        toggleButton.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        });

        // Load dark mode preference on page load
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
        }
    </script>

    <!-- Speech Bubble for Error Messages -->
    <script>
        function showErrorMessage(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = message;
            errorMessage.classList.add('show');

            setTimeout(() => {
                errorMessage.classList.remove('show');
            }, 5000); // Message disappears after 5 seconds
        }
    </script>

    <!-- Character Counter for Post Creation -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const textArea = document.getElementById('postContent');
            const charCount = document.getElementById('charCount');
            const maxChars = 500;

            if (textArea && charCount) {
                textArea.addEventListener('input', () => {
                    const remaining = maxChars - textArea.value.length;
                    charCount.textContent = `${remaining} characters remaining`;
                });
            }
        });
    </script>
</body>
</html>

