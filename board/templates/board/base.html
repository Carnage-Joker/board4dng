<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <title>{% block title %}My Message Board{% endblock %}</title>
    
    <!-- Manifest & Theme Color -->
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <meta name="theme-color" content="#ff66cc">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">

    <!-- Firebase SDK for Messaging -->
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-messaging.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register("{% static 'service-worker.js' %}")
            .then(function(registration) {
                console.log('Service Worker registered with scope:', registration.scope);
            })
            .catch(function(error) {
                console.log('Service Worker registration failed:', error);
            });
        }
    </script>

    <!-- Fun UI Enhancements for Your Daughters -->
    <style>
        /* Button Styles */
        .btn-primary {
            background-color: #FF1493;
            border-color: #FF1493;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            box-shadow: 0px 4px 10px rgba(255, 20, 147, 0.5); /* Pink glow */
        }

        .btn-primary:hover {
            background-color: #FFC0CB;
            border-color: #FFC0CB;
            box-shadow: 0px 6px 12px rgba(255, 192, 203, 0.7); /* Larger pink glow */
        }

        .btn-secondary {
            background-color: #1E90FF;
            border-color: #1E90FF;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            box-shadow: 0px 4px 10px rgba(30, 144, 255, 0.5); /* Blue glow */
        }

        .btn-secondary:hover {
            background-color: #ADD8E6;
            border-color: #ADD8E6;
            box-shadow: 0px 6px 12px rgba(173, 216, 230, 0.7); /* Larger blue glow */
        }

        /* Dark Mode Styling */
        .dark-mode {
            background-color: #121212;
            color: #ffffff;
        }

        .dark-mode .navbar,
        .dark-mode .card {
            background-color: #333333;
            color: #ffffff;
        }

        .dark-mode .btn-primary {
            background-color: #bb86fc;
            border-color: #bb86fc;
        }

        /* Gradient Background */
        body {
            background: linear-gradient(90deg, #ff66cc, #ff99ff, #ffb3ff, #ffccff);
            background-size: 400% 400%;
            animation: gradientBG 10s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>

    {% block extra_head %}{% endblock %}
</head>

<body>

    <!-- Dark Mode Toggle Button -->
    <div class="container mt-3 text-center">
        <button id="darkModeToggle" class="btn btn-secondary">Toggle Dark Mode</button>
    </div>

    <div class="container mt-4 neon-border">
        {% block content %}{% endblock %}
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark mt-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="{% url 'welcome' %}">Message Board</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    {% if user.is_authenticated %}
                    <li class="nav-item"><a class="nav-link" href="{% url 'board:profile' user.username %}">Profile</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'board:create_post' %}">New Post</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'board:logout' %}">Logout</a></li>
                    {% else %}
                    <li class="nav-item"><a class="nav-link" href="{% url 'board:login' %}">Login</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'board:register' %}">Register</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Footer with Love -->
    <footer class="text-center">
        <p>&copy; 2024 Message Board | Built with ❤️ and Python</p>
    </footer>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Dark Mode Toggle -->
    <script>
        const toggleButton = document.getElementById('darkModeToggle');
        toggleButton.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        });

        // Load dark mode preference on page load
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
        }
    </script>

    <!-- Firebase Initialization and Push Notifications -->
   <script>
        // Initialize Firebase using values from Django context
        const firebaseConfig = {
            apiKey: "{{ firebase_config.apiKey }}",
            authDomain: "{{ firebase_config.authDomain }}",
            projectId: "{{ firebase_config.projectId }}",
            storageBucket: "{{ firebase_config.storageBucket }}",
            messagingSenderId: "{{ firebase_config.messagingSenderId }}",
            appId: "{{ firebase_config.appId }}",
            measurementId: "{{ firebase_config.measurementId }}"
        };
        firebase.initializeApp(firebaseConfig);
        const messaging = firebase.messaging();
  
    </script>

</body>
</html>
